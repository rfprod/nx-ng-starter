# For more information see: https://help.github.com/actions/language-and-framework-guides/using-nodejs-with-github-actions

name: publish-client-d3-charts

on:
  push:
    branches: [main]

defaults:
  run:
    shell: bash

concurrency:
  group: ${{ github.ref_name }}.${{ github.sha }}.publish-client-d3-charts
  cancel-in-progress: true

jobs:
  publish-client-d3-charts:
    runs-on: ubuntu-latest

    strategy:
      matrix:
        node-version: [16.x]

    steps:
      - name: Checkout sources
        uses: actions/checkout@v3

      - name: Detect changes
        uses: dorny/paths-filter@v2
        id: changes
        with:
          filters: |
            package:
              - 'libs/client-d3-charts/package.json'

      - name: Check repository owner
        if: ${{ steps.changes.outputs.package == 'true' }}
        id: check-repo-owner
        uses: ./.github/actions/check-repo-owner

      - name: NPM publish
        if: ${{ steps.check-repo-owner.outputs.origin == 'true' && steps.changes.outputs.package == 'true' }}
        uses: ./.github/actions/npm-publish
        with:
          node-version: ${{ matrix.node-version }}
          library-name: client-d3-charts
